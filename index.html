<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover" />
  <title>For Emma ‚ù§Ô∏è</title>
  <link rel="icon" href="https://fav.farm/‚ù§Ô∏è" />

  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>

  <style>
    :root {
      --bg1: #ffd6e7;
      --bg2: #ffeef6;
      --card: #ffffffcc;
      --yes: #ff3b7a;
    }

    * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

    body {
      margin: 0;
      padding: env(safe-area-inset-top) 20px env(safe-area-inset-bottom) 20px;
      min-height: 100svh;
      display: flex;
      align-items: center;
      justify-content: center;
      background: radial-gradient(circle at top, var(--bg2), var(--bg1));
      font-family: -apple-system, system-ui, sans-serif;
      overflow: hidden;
      touch-action: none;
    }

    .card {
      width: 100%;
      max-width: 380px;
      padding: 25px;
      background: var(--card);
      backdrop-filter: blur(15px);
      -webkit-backdrop-filter: blur(15px);
      border-radius: 30px;
      text-align: center;
      box-shadow: 0 20px 50px rgba(0,0,0,0.1);
      z-index: 10;
      position: relative;
    }

    .hug-heart {
      position: fixed; 
      top: 8%; /* Higher for mobile view */
      font-size: 50px; 
      opacity: 0; 
      z-index: 99999; 
      transition: all 1.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      pointer-events: none;
    }

    .art { width: 130px; height: auto; margin: 0 auto 10px; display: block; }
    h1 { font-size: 1.5rem; margin: 10px 0 20px; color: #333; line-height: 1.2; }

    .button-zone {
      position: relative;
      width: 100%;
      height: 180px;
      margin: 0 auto;
    }

    button {
      position: absolute;
      padding: 16px 28px;
      font-size: 18px;
      font-weight: 800;
      border-radius: 50px;
      border: none;
      box-shadow: 0 8px 20px rgba(0,0,0,0.1);
      transition: transform 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275), left 0.3s ease-out, top 0.3s ease-out;
    }

    #yesBtn { left: 10%; top: 30%; background: var(--yes); color: #fff; z-index: 100; }
    #noBtn { right: 10%; top: 30%; background: #eee; color: #444; z-index: 50; }

    #noComment {
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      font-size: 14px;
      color: #ff3b7a;
      font-weight: 700;
      opacity: 0;
      transition: opacity 0.3s;
    }

    .result { display: none; animation: pop 0.5s ease forwards; }
    
    #subText { 
      font-size: 1.1rem; 
      color: #ff3b7a; 
      font-weight: 600; 
      margin: 15px 0; 
      min-height: 3.5em;
      position: relative;
      background: rgba(255, 255, 255, 0.4);
      border-radius: 15px;
      padding: 10px;
    }
    
    #saveTheDate {
      display: none;
      margin-top: 15px;
      padding: 15px;
      background: white;
      border-radius: 20px;
      border: 2px dashed var(--yes);
    }

    .calendar { font-weight: 900; color: var(--yes); font-size: 1.5rem; display: block; margin-top: 5px; }

    .shiba-gif { 
      width: 100%; 
      max-width: 180px; 
      border-radius: 15px; 
      margin-top: 15px; 
    }

    #musicToggle {
      position: fixed; top: 20px; right: 20px;
      background: #fff; width: 44px; height: 44px; border-radius: 50%;
      display: none; align-items: center; justify-content: center;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1); z-index: 10001; font-size: 20px;
    }

    @keyframes pop { 0% { transform: scale(0.8); opacity: 0; } 100% { transform: scale(1); opacity: 1; } }

    .heart-particle {
      position: fixed; font-size: 20px; animation: floatUp 4s linear forwards; z-index: 1;
    }
    @keyframes floatUp {
      0% { transform: translateY(105vh); opacity: 1; }
      100% { transform: translateY(-10vh); opacity: 0; }
    }
  </style>
</head>

<body>
  <div id="musicToggle" onclick="toggleMusic()">üéµ</div>
  <audio id="vibe" src="our-song.m4a" loop></audio>

  <main class="card">
    <div id="setup">
      <svg class="art" viewBox="0 0 320 240">
        <path d="M250 50 C250 33 270 25 282 38 C294 25 314 33 314 50 C314 78 282 92 282 106 C282 92 250 78 250 50Z" fill="#ff1f68"/>
        <path d="M90 120 C90 70 140 40 190 60 C240 40 290 70 290 120 C290 180 240 210 190 210 C140 210 90 180 90 120Z" fill="#f2a97b"/>
        <circle cx="160" cy="130" r="8" fill="#333"/><circle cx="220" cy="130" r="8" fill="#333"/>
        <path d="M190 144 C186 144 182 148 182 152 C182 160 190 164 190 170 C190 164 198 160 198 152 C198 148 194 144 190 144Z" fill="#ff7aa2"/>
      </svg>
      <h1>Emma, will you be my valentine?</h1>
      <div class="button-zone" id="zone">
        <button id="yesBtn">Yes</button>
        <button id="noBtn">No</button>
        <div id="noComment">Nice try! üòâ</div>
      </div>
    </div>

    <div class="result" id="result">
      <h2>YAY! üéâ</h2>
      <p id="subText"></p>
      <div id="saveTheDate">
        <span>Counting down until we meet:</span>
        <strong class="calendar">APRIL 13 üóìÔ∏è‚ù§Ô∏è</strong>
      </div>
      <img class="shiba-gif" src="https://static.boredpanda.com/blog/wp-content/uploads/2018/05/funny-shiba-inu-26-5ae9b4c97986a__700.gif" alt="Happy Shiba">
    </div>
  </main>

  <script>
    const yesBtn = document.getElementById('yesBtn');
    const noBtn = document.getElementById('noBtn');
    const vibe = document.getElementById('vibe');
    const zone = document.getElementById('zone');
    const subText = document.getElementById('subText');
    const noComment = document.getElementById('noComment');
    const saveDateDiv = document.getElementById('saveTheDate');
    
    let yesScale = 1;
    let noClicks = 0;
    const comments = [
      "Nice try! üòâ",
      "Almost had it! üòú",
      "You're persistent! üòÇ",
      "Is that all you got? üíÖ",
      "Just click Yes, Emma! ‚ù§Ô∏è"
    ];

    function moveNo() {
      noClicks++;
      const bZone = zone.getBoundingClientRect();
      const bNo = noBtn.getBoundingClientRect();
      const newX = Math.random() * (bZone.width - bNo.width);
      const newY = Math.random() * (bZone.height - bNo.height);
      
      noBtn.style.left = `${newX}px`;
      noBtn.style.top = `${newY}px`;
      
      yesScale += 0.2;
      yesBtn.style.transform = `scale(${yesScale})`;

      if (noClicks > 2) {
        noComment.style.opacity = "1";
        noComment.innerText = comments[Math.min(noClicks - 3, comments.length - 1)];
      }
    }

    noBtn.addEventListener('touchstart', (e) => { e.preventDefault(); moveNo(); });
    noBtn.addEventListener('mouseover', moveNo);

    function toggleMusic() {
      if (vibe.paused) vibe.play(); else vibe.pause();
    }

    yesBtn.addEventListener('click', () => {
      document.getElementById('setup').style.display = 'none';
      document.getElementById('result').style.display = 'block';
      document.getElementById('musicToggle').style.display = 'flex';
      
      vibe.volume = 0.5;
      vibe.play();
      
      confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } });

      const h1 = document.createElement("div"); h1.innerHTML = "‚ù§Ô∏è"; h1.className = "hug-heart"; h1.style.left = "0";
      const h2 = document.createElement("div"); h2.innerHTML = "‚ù§Ô∏è"; h2.className = "hug-heart"; h2.style.right = "0";
      document.body.appendChild(h1); document.body.appendChild(h2);
      
      setTimeout(() => {
        h1.style.left = "50%"; h1.style.transform = "translateX(-130%)"; h1.style.opacity = "1";
        h2.style.right = "50%"; h2.style.transform = "translateX(130%)"; h2.style.opacity = "1";
      }, 100);

      const messages = [
        "I knew you'd say yes! üòâ",
        "Distance is just a test of love.",
        "Worth every single mile, Emma.",
        "Across every mile, you are my Valentine! ‚úàÔ∏è‚ù§Ô∏è"
      ];

      let i = 0;
      const interval = setInterval(() => {
        if (i < messages.length) {
          subText.innerHTML = messages[i];
          i++;
        } else {
          clearInterval(interval);
          saveDateDiv.style.display = "block";
        }
      }, 2600);

      setInterval(() => {
        const heart = document.createElement("div");
        heart.innerHTML = "‚ù§Ô∏è";
        heart.className = "heart-particle";
        heart.style.left = Math.random() * 100 + "vw";
        document.body.appendChild(heart);
        setTimeout(() => heart.remove(), 4000);
      }, 500);
    });
  </script>
</body>
</html>
